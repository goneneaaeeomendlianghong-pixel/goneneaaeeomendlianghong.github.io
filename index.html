<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>思库 · 个人长期信息资产与决策回溯系统</title>
    <link rel="stylesheet" href="./assets/styles.css?v=20260211-1" />
  </head>
  <body>
    <div class="layout">
      <aside class="sidebar">
        <div class="sidebar-brand">
          <div class="brand-block">思库</div>
          <div class="brand-sub">专注思考，长期沉淀</div>
        </div>
        <nav class="sidebar-nav">
          <a class="nav-item active" data-view="dashboard"><span class="icon-slot" data-icon="bulb"></span>工作台</a>
          <a class="nav-item" data-view="history"><span class="icon-slot" data-icon="meeting"></span>我的记录</a>
          <a class="nav-item" data-view="notes"><span class="icon-slot" data-icon="project"></span>笔记</a>
          
          <a class="nav-item" data-view="keywords"><span class="icon-slot" data-icon="tag"></span>关键词</a>
          
          <a class="nav-item" data-view="files"><span class="icon-slot" data-icon="life"></span>文件库</a>
          <a class="nav-item" data-view="database"><span class="icon-slot" data-icon="customer"></span>数据库</a>
        </nav>
        <div class="sidebar-footer">
          <a class="nav-item" id="open-trash" data-view="trash"><span aria-hidden="true" style="margin-right:6px">🗑</span>废纸篓</a>
        </div>
      </aside>
      <main class="page">
        <div class="topbar">
          <div class="slogan">让每一个想法成为长期资产</div>
          <div class="topbar-right">
            <div class="search">
              <input id="search-input" type="text" placeholder="搜索标题、内容或标签..." />
            </div>
            <button id="btn-new-note" class="create-btn"><span class="plus">+</span> 新建笔记</button>
          </div>
        </div>
        <div class="grad-bar"></div>
        <div class="filters" style="display:none;">
          <div class="chips">
            <button class="chip active" data-tag="全部">全部</button>
            <button class="chip" data-tag="想法">想法</button>
            <button class="chip" data-tag="会议">会议</button>
            <button class="chip" data-tag="待办">待办</button>
            <button class="chip" data-tag="决策">决策</button>
          </div>
          <div class="time-select">
            <select id="time-range">
              <option>全部时间</option>
              <option>今天</option>
              <option>本周</option>
              <option>本月</option>
            </select>
          </div>
        </div>
        <div class="content" id="view-notes">
          <div class="list">
            <div class="list-head">共 <span id="note-count">0</span> 条记录</div>
            <div id="note-list" class="note-list"></div>
          </div>
          <div class="preview">
            <div class="empty">
              <div class="empty-icon"></div>
              <div class="empty-title">开始记录你的想法</div>
              <div class="empty-sub">选择一条笔记或创建新笔记</div>
            </div>
          </div>
        </div>
        <div class="content" id="view-dashboard">
          <div class="list">
            <div class="list-head">今日智能提醒</div>
            <div id="dash-reminders" class="note-list"></div>
            <div class="list-head" style="margin-top:16px;">我的决策场景</div>
            <div id="dash-scenes" class="chips"></div>
            <div class="list-head" style="margin-top:16px;">待处理决策</div>
            <div id="dash-todo" class="note-list"></div>
            <div class="list-head" style="margin-top:16px;">已解决决策</div>
            <div id="dash-solved" class="note-list"></div>
            <div class="list-head" style="margin-top:16px;">我的关键词</div>
            <div id="dash-keywords" class="chips"></div>
            
          </div>
          <div class="preview">
            <div class="empty">
              <div class="empty-icon"></div>
              <div class="empty-title">快速新建</div>
              <div class="empty-sub">点击下方按钮开始一条新的决策记录</div>
              <div style="margin-top:12px;"><button id="dash-new" class="create-btn"><span class="plus">+</span> 新建记录</button></div>
            </div>
          </div>
        </div>
        <div class="content" id="view-report" style="display:none;">
          <div class="list">
            <div class="list-head">决策记录（演示）</div>
            <div id="report-list" class="note-list"></div>
          </div>
          <div class="preview">
            <div class="viewer">
              <div id="report-output" class="note-list"></div>
            </div>
          </div>
        </div>

        <div class="content" id="view-history" style="display:none;">
          <div class="list">
            <div class="list-head">按时间顺序排列</div>
            <div id="history-list" class="note-list"></div>
            <div id="timeline-list" class="timeline-list" style="display:none;"></div>
            <div id="insights-list" class="insights-list" style="display:none;"></div>
            <div id="chains-list" class="note-list" style="display:none;"></div>
          </div>
          <div class="preview">
            <div class="empty">
              <div class="empty-icon"></div>
              <div class="empty-title">记录详情</div>
              <div class="empty-sub">点击左侧记录查看完整内容</div>
            </div>
          </div>
        </div>

        <div class="content" id="view-database" style="display:none;">
          <div class="list">
            <div class="list-head">数据库 · 识别后的文本</div>
            <div class="row" style="margin-bottom:8px;">
              <input id="db-upload" type="file" multiple />
            </div>
            <div id="db-list" class="note-list"></div>
          </div>
          <div class="preview">
            <div class="empty">
              <div class="empty-icon"></div>
              <div class="empty-title">文本识别结果预览</div>
              <div class="empty-sub">选择左侧项目查看识别文本</div>
            </div>
          </div>
        </div>

        <div class="content" id="view-files" style="display:none;">
          <div class="list">
            <div class="list-head">文件库 · 源文件</div>
            <div class="row" style="margin-bottom:8px;">
              <input id="file-upload" type="file" multiple />
            </div>
            <div id="file-list" class="note-list"></div>
          </div>
          <div class="preview">
            <div class="empty">
              <div class="empty-icon"></div>
              <div class="empty-title">文件预览</div>
              <div class="empty-sub">选择左侧文件进行本地预览或下载</div>
            </div>
          </div>
        </div>

        <div class="compose-page" id="view-compose" style="display:none;">
          <div class="compose-toolbar">
            <button class="chip active" id="compose-type"><span class="icon-slot" data-icon="bulb"></span>想法</button>
            <button class="chip" id="compose-attach"><span class="icon-slot" data-icon="paperclip"></span>附件</button>
            <input id="compose-upload" type="file" multiple style="display:none;" />
            <button class="brand-chip" id="compose-ai">AI生成摘要</button>
            <button class="create-btn" id="compose-save">保存</button>
          </div>
          <div class="compose-body">
            <div class="row" style="gap:8px; margin-bottom:8px;">
              <input id="compose-title" class="input" placeholder="问题/主题（必填）" />
              <input id="compose-scene" class="input" list="scene-list" placeholder="决策场景（必填，可自定义）" />
              <datalist id="scene-list"></datalist>
            </div>
            <div id="compose-related-panel" class="evidence-panel" style="display:none;">
              <div class="evidence-title">你之前思考过类似问题 ↓</div>
              <div id="compose-related-list"></div>
            </div>
            <textarea class="compose-text" id="compose-text" placeholder="我遇到的问题：&#10;我的思考/结论：&#10;我为什么这么想：&#10;下次再遇到类似情况，我应该："></textarea>
            <div id="compose-evidence" class="evidence-panel"></div>
          </div>
        </div>
        
        <div class="content" id="view-keywords" style="display:none;">
          <div class="list">
            <div class="list-head">我的关键词</div>
            <div class="row" style="gap:8px; margin-bottom:8px;">
              <button id="kw-rename" class="chip">重命名</button>
              <button id="kw-merge" class="chip">合并</button>
              <button id="kw-delete" class="chip">删除</button>
            </div>
            <div id="kw-list" class="chips"></div>
          </div>
          <div class="preview">
            <div class="empty">
              <div class="empty-icon"></div>
              <div class="empty-title">相关记录</div>
              <div class="empty-sub">点击左侧关键词查看历史思考</div>
            </div>
            <div id="kw-related" class="note-list"></div>
          </div>
        </div>
        
        <div class="content" id="view-trash" style="display:none;">
          <div class="list">
            <div class="list-head">废纸篓 <button id="trash-empty" class="chip">清空废纸篓</button></div>
            <div id="trash-list" class="note-list"></div>
          </div>
          <div class="preview">
            <div class="empty">
              <div class="empty-icon"></div>
              <div class="empty-title">已移至废纸篓</div>
              <div class="empty-sub">选择左侧项目进行还原或彻底删除</div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <aside id="hint-panel" class="hint-panel">
      <div class="hint-header">你可能也需要 · 相关历史记录</div>
      <div id="hint-list" class="hint-list"></div>
    </aside>

    <footer class="app-footer">
      <span>统一收集 · 自动结构化 · 长期沉淀 · 可回溯、可复用</span>
    </footer>
    <div id="toast" class="toast" style="display:none;"></div>

    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
    <script type="module" src="./assets/app.js?v=20260213-1"></script>
 <!-- OpenAI AI问答功能（复制即用，只改1处IP） -->
<div style="width: 90%; margin: 30px auto; padding: 20px; border: 1px solid #e0e0e0; border-radius: 8px; background: #f9f9f9;">
    <h3 style="color: #333; margin-top: 0;">AI智能问答（对接OpenAI）</h3>
    <textarea id="aiQuestion" style="width: 100%; height: 120px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; resize: none; margin-bottom: 10px; font-size: 16px;" placeholder="请输入你要提问的内容，比如：如何优化移动端下单流程？"></textarea>
    <button onclick="callOpenAI()" style="padding: 10px 25px; background: #165DFF; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; margin-bottom: 10px;">提问OpenAI</button>
    <div id="aiAnswer" style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; background: white; color: #333; font-size: 16px; line-height: 1.6;">等待你的提问...</div>
</div>

<script>
// 调用OpenAI的核心函数，只改1处Mac本地IP！
async function callOpenAI() {
    // ====================== 只改这1处！=====================
    const macIP = "192.168.130.79"; // 替换成你的Mac本地IP（第四步获取的）
    // =======================================================
    const question = document.getElementById("aiQuestion").value;
    const answerBox = document.getElementById("aiAnswer");
    // 显示加载状态
    answerBox.innerText = "AI正在思考中...请稍候";
    try {
        // 调用Mac本地中转服务器
        const response = await fetch(`http://${macIP}:8081/chat`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ prompt: question })
        });
        const data = await response.json();
        // 显示OpenAI的真实回答
        answerBox.innerText = data.answer;
    } catch (err) {
        answerBox.innerText = `调用成功提示：${err.message}，请检查Mac本地IP是否正确/中转服务器是否启动`;
    }
}
</script> </body>
</html>
「添加 OpenAI AI 问答功能」
